# Full table scan
query TI rowsort
select * from simple
----
Alice 25
Bob 30

# Cross join
query TITI rowsort
select * from simple as t1 join simple as t2
----
Alice 25 Alice 25
Alice 25 Bob 30
Bob 30 Alice 25
Bob 30 Bob 30

# Nested loop join
query TITI rowsort
select * from simple as t1 join simple as t2 on t1.age > t2.age
----
Bob 30 Alice 25

# Change hash join settings to make hash join partitioned
statement ok
set datafusion.optimizer.hash_join_single_partition_threshold = 0;

statement ok
set datafusion.optimizer.hash_join_single_partition_threshold_rows = 0;

# Hash join (partitioned)
query TITI rowsort
select * from simple as t1 join simple as t2 on t1.name = t2.name
----
Alice 25 Alice 25
Bob 30 Bob 30

# Restore hash join settings
statement ok
set datafusion.optimizer.hash_join_single_partition_threshold = 1048576;

statement ok
set datafusion.optimizer.hash_join_single_partition_threshold_rows = 131072;

# Hash join (collect left)
query TITI rowsort
select * from simple as t1 join simple as t2 on t1.name = t2.name
----
Alice 25 Alice 25
Bob 30 Bob 30

# Union aggregate
query TI rowsort
select * from simple union select * from simple
----
Alice 25
Bob 30

# Sort with preserve partitioning
query TI
select * from simple order by age
----
Alice 25
Bob 30